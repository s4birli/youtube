#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import sys
import time
import os

def process_chrome_cookies(input_file, output_file):
    try:
        with open(input_file, 'r', encoding='utf-8') as f:
            lines = f.readlines()
        
        with open(output_file, 'w', encoding='utf-8') as f:
            # Netscape cookie formatÄ± baÅŸlÄ±ÄŸÄ±
            f.write("# Netscape HTTP Cookie File\n")
            f.write("# https://curl.haxx.se/docs/http-cookies.html\n")
            f.write("# This file was generated by cookie_converter.py\n\n")
            
            # Her satÄ±rÄ± iÅŸle
            for line in lines:
                line = line.strip()
                if not line or line.startswith('#'):
                    continue
                
                parts = line.split('\t')
                if len(parts) >= 5:
                    try:
                        name = parts[0]
                        value = parts[1]
                        domain = parts[2]
                        path = parts[3]
                        expiry = int(time.time()) + 86400*30  # 30 gÃ¼n
                        secure = "TRUE" if "TRUE" in line.upper() or "SECURE" in line.upper() else "FALSE"
                        
                        # Domain'i dÃ¼zelt
                        if not domain.startswith('.') and '.' in domain:
                            domain = '.' + domain
                        
                        # Netscape formatÄ±: domain TAB flag TAB path TAB secure TAB expiry TAB name TAB value
                        f.write(f"{domain}\tTRUE\t{path}\t{secure}\t{expiry}\t{name}\t{value}\n")
                    except Exception as e:
                        sys.stderr.write(f"SatÄ±r iÅŸlenirken hata: {line} - {str(e)}\n")
        
        print(f"âœ… Cookie'ler baÅŸarÄ±yla {output_file} dosyasÄ±na kaydedildi!")
        return True
    except Exception as e:
        print(f"âŒ Hata: {str(e)}")
        return False

def main():
    if len(sys.argv) != 2:
        print("""
ğŸª Chrome Cookie -> Netscape Format DÃ¶nÃ¼ÅŸtÃ¼rÃ¼cÃ¼ ğŸª
KullanÄ±m: python cookie_converter.py chrome_cookies.txt

1. Chrome tarayÄ±cÄ±nÄ±zÄ± aÃ§Ä±n
2. YouTube'a gidin ve hesabÄ±nÄ±za giriÅŸ yapÄ±n
3. F12 tuÅŸuna basarak Developer Tools'u aÃ§Ä±n
4. "Application" sekmesine tÄ±klayÄ±n
5. Sol tarafta "Storage" > "Cookies" > "https://www.youtube.com" seÃ§in
6. TÃ¼m cookie'leri seÃ§in (Ctrl+A veya âŒ˜+A) ve kopyalayÄ±n
7. chrome_cookies.txt dosyasÄ±na yapÄ±ÅŸtÄ±rÄ±n
8. Bu scripti Ã§alÄ±ÅŸtÄ±rÄ±n: python cookie_converter.py chrome_cookies.txt
""")
        sys.exit(1)
    
    input_file = sys.argv[1]
    output_file = os.path.join(os.path.dirname(os.path.abspath(__file__)), "youtube_cookies.txt")
    process_chrome_cookies(input_file, output_file)

if __name__ == "__main__":
    main()
